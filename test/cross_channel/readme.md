# 跨域交流
### *.痛点
#### 有些需求需要两个不同的网页相互交流,看了`localstorage`和`indexedDB`要求,发现这个只能同域,就想到了用`GM`来交流,`GM`能无视跨域的问题.当然`localstorage`和`indexedDB`我也有保留,毕竟大部分需求都是同域
### *.原理
#### 通过用一条字符串数据改成`{val:string}`,`val`是json字符串,这样双方网页只要读取第一条数据解析成json进行交互即可,修改后再保存json为字符串放回`val`.
### *.详解
#### `CrossChannelMain` 跨域主逻辑,含有轮询机制,一般用在主网页上,也可以用在副网页(如果真的使用,要看看要不要初始化化数据,不要瞎忙活)
#### `CrossChannelOther` 跨域副逻辑,只有一次触发,一般用在副网页上
### *.注意事项
#### 由于`indexedDB`同时只允许一个事务写入,要注意写入顺序,尤其是带有多个主逻辑触发,`GM`和`localstorage`是同步的,基本没有很大的问题